Bootstrap: docker
From: julia:0.3.11

%files
    containers/cyclops/runCYCLOPS.jl /runCYCLOPS.jl

%environment
    export JULIA_PKGDIR=/opt/julia/v0.3

%post
    apt-get update && apt-get install -y git-all
    git clone https://github.com/gangwug/Oslops.git /Oslops

    # Configure a directory to place Julia packages
    export JULIA_PKGDIR=/opt/julia
    export PATH=/usr/local/julia/bin:$PATH
    
    # Get the package metadata from git using https because the Julia v0.3 Pkg manager
    # uses a now-deprecated git:// option that timesout with github
    mkdir /opt/julia
    mkdir /opt/julia/v0.3
    git clone https://github.com/JuliaLang/METADATA.jl.git /opt/julia/v0.3/METADATA

    julia -e 'using Base.Pkg; Base.Pkg.add("ArgParse")'
    julia -e 'using Base.Pkg; Base.Pkg.add("StatsBase")'
    julia -e 'using Base.Pkg; Base.Pkg.add("MultivariateStats")'
    julia -e 'using Base.Pkg; Base.Pkg.add("Distributions")'

    # Permissions
    chmod -R 645 /opt/julia
    chmod 645 /runCYCLOPS.jl

%runscript
    julia /runCYCLOPS.jl "$@"

%help
    CYCLOPS (Cyclic Ordering by Periodic Structure) is a tool designed to reconstruct the temporal ordering of high dimensional that is generated by a common periodic process.

    See https://github.com/ranafi/CYCLOPS
